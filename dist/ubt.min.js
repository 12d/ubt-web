(function(){"use strict";var t=function(){var t="";for(var e=0;e<4;e++){t+="0000000".concat(Math.floor(Math.random()*2821109907456).toString(36)).slice(-8)}return t};var e="https://web-ubt.ele.me/par.gif";var r="https://web-ubt.ele.me/tracking.gif";var n=function(t,e){this.type=t||"UNKNOWN";this.params=e||{}};n.prototype.bindData=function(){var t=function(){};t.prototype=this.params;var e=new t;for(var r=0;r<arguments.length;r++){var a=arguments[r];for(var i in a){e[i]=a[i]}}return new n(this.type,e)};n.prototype.bindType=function(t){return new n(t,this.params)};n.prototype.bind=function(){var t=Array.prototype.slice.call(arguments);var e=typeof t[0]==="string"?t.shift():this.type;var r=this.bindData.apply(this,t).params;return new n(e,r)};n.prototype.send=function(){var n=this.bind.apply(this,arguments);var i=n.params;var o=i.type=n.type;var u;if(o==="PV"){u=r;a.params.pvhash=t()}else{u=e}for(var c in i){var s=i[c];if(typeof s==="function"){i[c]=s()}else{i[c]=i[c]}}var f=encodeURIComponent(JSON.stringify(i));(new Image).src=u+"?"+f};var a=new n("DEFAULT",new function(){this.ssid=document.cookie.match(/(?:^|; )ubt_ssid=(.*?)(?:; |$)|$/)[1];if(!this.ssid){var e=new Date((new Date).getTime()+480*6e4);this.ssid=t()+"_"+[e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate()].join("-").replace(/\b\d\b/g,"0$&");var r=document.domain.match(/[\w-]+\.?[\w-]+$/)[0];document.cookie="ubt_ssid="+this.ssid+"; Expires=Wed, 31 Dec 2098 16:00:00 GMT; Domain="+r+"; Path=/"}this.timestamp=function(){return(new Date).getTime().toString(36)}});var i=document.documentElement;a.send("PV",{resolution:Math.max(i.clientWidth,window.innerWidth||0)+"x"+Math.max(i.clientHeight,window.innerHeight||0),location:location.href,referrer:document.referrer});var o=a;var u=function(t,e,r){var n=function(t){t=t||event;var e={target:t.target||t.srcElement};r.call(e.target,e)};if(t.addEventListener){t.addEventListener(e,n,true)}else if(t.attachEvent){t.attachEvent("on"+e,n)}};var c=function(){setTimeout(function(){var t=performance.timing;var e=["fetchStart","connectEnd","connectStart","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domLoading","domainLookupEnd","domainLookupStart","loadEventEnd","loadEventStart","requestStart","responseEnd","responseStart"];var r={};for(var n=0;n<e.length;n++){r[e[n]]=t[e[n]]-t.navigationStart}o.send("TIMING",r)})};if(window.performance&&window.performance.timing)u(window,"load",c);var s={};var f=10;var v=function(t){if(!t||s[t]||f<=0)return;o.send("JSERROR",{message:t});s[t]=true;f--};if(window.addEventListener){addEventListener("error",function(t){v(t.error&&t.error.stack)})}else if(window.attachEvent){attachEvent("onerror",function(t,e,r){v([t,"url: "+e,"line: "+r].join("\r\n"))})}var d=function(t,e){for(var r=t;r&&r.nodeType===1;r=r.parentNode){if(e(r)===false)break}};var l=function(t){var e;switch(t.tagName){case"A":return t.getAttribute("href");case"INPUT":if(/checkbox|radio/.test(t.type))return t.checked;case"TEXTAREA":return t.value;case"SELECT":var r=t.getElementsByTagName("option");for(var n=0;n<r.length;n++){if(r[n].selected){return r[n].hasAttribute("value")?r[n].getAttribute("value"):r[n].innerHTML}}return null;default:if(t.tagName==="LABEL"||t.hasAttribute("ubt-label")){var a=t.getAttribute("for");var e=a?document.getElementById(a):t.querySelector("input,textarea");return e?l(e):null}}};var m=l;var g=function(t){var e;if(t.tagName==="INPUT"){e=t.id&&document.querySelector('[for="'+t.id+'"]');if(!e){d(t,function(t){if(t.tagName!=="LABEL"&&!t.hasAttribute("ubt-label"))return;e=t;return false})}if(e)t=e}var r;if(!/TEXTAREA|SELECT/.test(t.tagName))r=String(t.textContent||t.innerText||"").replace(/^\s+|\s+$/g,"");return r||t.title||t.alt||t.name||t.getAttribute("placeholder")};var p=function(t){var e={value:m(t),message:g(t)};var r=t.attributes;var n,a;for(a=0;a<r.length;a++){n=r[a];if(/^ubt-data-(\w+)/.test(n.name)){e[RegExp.$1]=n.value}}return e};var h="ubt-click";var E=function(t){o.send("EVENT",{id:t.getAttribute(h),params:p(t)})};u(document,"click",function(t){var e=t.target;if(e.tagName==="LABEL"&&e.querySelector("input,textarea"))return;d(e,function(t){if(t.hasAttribute(h))E(t)})});var b="ubt-change";var w=b+"-installed";var y=function(t,e){u(t,"change",function(t){o.send("EVENT",{id:t.target.getAttribute(b),params:p(t.target)})})};var T=["input","textarea","select"];var A=function(t){if(t[w])return;t[w]=true;y(t,t.getAttribute(b))};var L=function(t){var e=t.target;if(!new RegExp(T.join("|"),"i").test(e.tagName)){var r=e.tagName==="LABEL"&&e;if(!r){d(e,function(t){r=t.tagName==="LABEL"&&t;if(r)return false})}if(r){var n=r.getAttribute("for");var e=n?document.getElementById(n):r.querySelector(T)}}if(e&&e.hasAttribute(b))A(e)};u(document,"mousedown",L);u(document,"keydown",L);var N="ubt-visit";var S={};var k=function(t){var e=t.getAttribute(N);if(!S[e]){o.send("EVENT",{id:e,params:p(t)});S[e]=true}t.removeAttribute(N)};var x=function(t){if(t.offsetWidth+t.offsetHeight)k(t)};var B=function(){var t=document.querySelectorAll("["+N+"]");for(var e=0;e<t.length;e++)x(t[e]);setTimeout(B,800)};B();void function(){switch(true){case typeof angular==="object"&&typeof angular.module==="function":return angular.module("UBT",[]).factory("UBT",function(){return o});default:[eval][0]("var UBT");window.UBT=o}}()}).call(this);